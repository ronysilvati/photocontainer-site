{% extends 'partials/base.html.twig' %}

{% block content %}

{%
  include 'partials/components/navbar-top.twig' with {
  'profile': grav.user.profile,
  'active': 'gallery',
  'class': 'bg-ph'
  }
%}

<div class="app page-gallery">

  {%
    include 'partials/components/page-header.twig' with {
      'title': 'Galeria',
      'show': ['title','form-search', 'nav-gallery']
    }
  %}

  <div class="container">
    {{ include('partials/components/filters-list.twig') }}

    {% if grav.user.profile == 3 and page.slug() == "historic" %}
    <div class="row">
      <div class="col-6 col-md-3 offset-md-3">
        <button type="button" class="btn btn-pu text-uppercase btn-block rounded-top-right-0 rounded-bottom-right-0">Fotos favoritas</button>
      </div>
      <div class="col-6 col-md-3 mb-5">
        <button type="button" class="btn btn-secondary text-uppercase btn-block rounded-top-left-0 rounded-bottom-left-0">Fotos baixadas</button>
      </div>
    </div>
    {% endif %}

    <div id="gallery" class="row row-sm">
      {% if grav.user.profile == 2 %}
      <div class="col-lg-3 col-md-4 col-sm-6 col-12 add-gallery-click">
        <a href="{{ base_url_absolute  }}/gallery/add" class="card thumb-gallery ratio-1by1 thumb-add">
          <span class="card-text-add">
            <i class="icon-plus"></i>
            <p class="text-uppercase">Novo álbum</p>
          </span>
        </a>
      </div>
      {% endif %}
    </div>
  </div>

   <a id="add-page" data-page="1" href="#">Próxima página</a>

  {{ include('partials/components/modal-filters.twig') }}
  {% include 'partials/components/footer.twig' with {'class': 'bg-ph'} %}
</div>

<script>
$( document ).ready(function(){
  Event.loadTags(localStorage.endpoint)

  $(".form-search").submit(function (e) {
    e.preventDefault();

    $(".search-result-thumb").remove()
    $("#add-page").data().page = 1

    Event.search("http://" + location.host + "/")
  })

  $('#gallery').lightGallery({
      subHtmlSelectorRelative: true
  });

  $( ".add-gallery-click" ).unbind();

  {% if page.slug() == "gallery" %}
    Event.search("http://" + location.host + "/");
  {% endif %}

  $("#add-page").on('click', function (e) {
    e.preventDefault()
    $(this).data().page += 1

    Event.search(localStorage.domain)
  })
});
</script>
{% endblock %}
